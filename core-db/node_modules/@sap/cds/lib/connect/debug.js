module.exports = function debug (driver) {
    return {__proto__: driver,
        set session(s){ driver.session = s },
        acquire(){ LOG('acquire connection')
            return driver.acquire() .then (dbc => ({__proto__: dbc,
                // execute(...args) {
                //     LOG (args[0])
                //     return dbc.execute(...args)
                // },
                _executeSQL (sql, args, ...etc) {
                    args ? LOG(sql,args) : LOG(sql)
                    return dbc._executeSQL (sql, args, ...etc)
                },

            }))
        },
        release (dbc) { LOG('release connection'); return driver.release (dbc.__proto__) },
        connect (...args) { LOG('connect'); return driver.connect (...args) },
    }
}


function LOG (...args) {
    process.stdout.write ('[cql] - '+ util.format (...args) +'\n')
}

const util = require ('util')
Object.assign (util.inspect.defaultOptions, {colors: true, depth: 11})